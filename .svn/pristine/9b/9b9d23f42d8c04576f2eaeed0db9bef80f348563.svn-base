package com.adtheorent.Testing;

import java.io.IOException;

import org.apache.http.ParseException;
import org.junit.Assert;
import org.junit.Test;
import org.openqa.selenium.firefox.FirefoxDriver;

public final class Targeting {
//@Test
//	public void testDeviceTargetingiPADOSiOSv9CarrierAttDeviceScenario() throws InterruptedException, ParseException, IOException {
//	System.out.println("Starting Device Targeting iPADOS iOSv9 Carrier Att Device Scenario");
//	DeviceTargeting myDevTargeting = new DeviceTargeting(new FirefoxDriver());
//	myDevTargeting.resetAllDeviceTargeting(); //This is inserted here as these test scripts are run randomly
//	Thread.sleep(10000);//Needed sleep so changes propagate through the DB
//	System.out.println("There should be NO targeting in place so this is expected to bid.");
//	String moPubRequest1 = "{\"app\":{\"bundle\":\"372648912\",\"cat\":[\"IAB24\",\"social_networking\"],\"id\":\"ba411a3edf074a9a9792ff8c56e193ae\",\"name\":\"MeetMe iPhone\",\"publisher\":{\"id\":\"c3584d1c40cb43619e043c065caee33a\",\"name\":\"MeetMe, Inc.\"},\"storeurl\":\"https://itunes.apple.com/us/app/meetme-chat-meet-new-people/id372648912?mt=8&uo=4\",\"ver\":\"10.3.0\"},\"at\":2,\"badv\":[\"badoo\",\"chatmeup\",\"fling\",\"happn\",\"howaboutwe\",\"imvu\",\"jaumo\",\"justhookup\",\"lavaplace\",\"lovoo\",\"meetmoi\",\"meowchat\",\"moco\",\"momo\",\"on.com\",\"pof\",\"sayhi\",\"skout\",\"tagged\",\"tango\",\"thegamebyhotornot\",\"tinder\",\"twoo\",\"wechat\",\"whisper\",\"zoosk\",\"landrover\",\"landrover.com\",\"landrovertristate.com\"],\"bcat\":[\"IAB25\",\"IAB25-2\",\"IAB25-3\",\"IAB25-4\",\"IAB25-5\",\"IAB26\",\"IAB26-1\",\"IAB26-2\",\"IAB26-3\",\"IAB26-4\",\"IAB3-7\"],\"device\":{\"carrier\":\"310-VZW\",\"connectiontype\":2,\"devicetype\":2,\"dnt\":0,\"dpidmd5\":\"9c6b132814c572f4eaad3bea5ad92354\",\"dpidsha1\":\"5096f9a6db54780f8f87c3736eb5063b3584d501\",\"ext\":{\"idfa\":\"203D9D0B-558D-4BDD-A186-9183546D9755\"},\"geo\":{\"city\":\"Saint Augustine\",\"country\":\"USA\",\"lat\":29.9475,\"lon\":-81.5264,\"metro\":\"109\",\"region\":\"FL\",\"zip\":\"32092\"},\"ip\":\"66.102.160.1\",\"js\":1,\"language\":\"en\",\"make\":\"Apple\",\"model\":\"iPhone 5S\",\"os\":\"iOS\",\"osv\":\"9\",\"ua\":\"Dalvik/2.1.0 (Linux; U; Android 5.1; XT1254 Build/SU3TL-39)\"},\"id\":\"09658018-6772-4e16-8fda-7a510bf61988\",\"imp\":[{\"banner\":{\"api\":[3,5],\"battr\":[1,3,8,9,10,14,6],\"btype\":[4],\"ext\":{\"nativebrowserclick\":1},\"h\":249,\"pos\":1,\"w\":300},\"bidfloor\":1,\"displaymanager\":\"mopub\",\"displaymanagerver\":\"3.7.0\",\"ext\":{\"secure\":0},\"id\":\"1\",\"instl\":0,\"tagid\":\"f5ea2d24c9bb46a38713cf98dffd8252\"}],\"user\":{\"gender\":\"f\",\"ext\":{\"age\":72},\"keywords\":\"ETHNICITY:NONE,RELIGION:NONE,AGE:21,INTERESTED_IN:WOMEN,EDUCATION:NONE,RELATIONSIP_STATUS:SINGLE,PARENTAL_STATE:NONE,GENDER:m\"}}";
//	Assert.assertNotEquals("This mopub request should have bid.", "No Bid", RequestCSVs.request(moPubRequest1));
//	
//	myDevTargeting.deviceiPADOSiOSv9CarrierAttDevice();
//	Thread.sleep(10000);
//	System.out.println("Seneding the same bid request.  With the new targeting in place, this request is NOT expected to bid");
//	String moPubRequest2 = "{\"app\":{\"bundle\":\"372648912\",\"cat\":[\"IAB24\",\"social_networking\"],\"id\":\"ba411a3edf074a9a9792ff8c56e193ae\",\"name\":\"MeetMe iPhone\",\"publisher\":{\"id\":\"c3584d1c40cb43619e043c065caee33a\",\"name\":\"MeetMe, Inc.\"},\"storeurl\":\"https://itunes.apple.com/us/app/meetme-chat-meet-new-people/id372648912?mt=8&uo=4\",\"ver\":\"10.3.0\"},\"at\":2,\"badv\":[\"badoo\",\"chatmeup\",\"fling\",\"happn\",\"howaboutwe\",\"imvu\",\"jaumo\",\"justhookup\",\"lavaplace\",\"lovoo\",\"meetmoi\",\"meowchat\",\"moco\",\"momo\",\"on.com\",\"pof\",\"sayhi\",\"skout\",\"tagged\",\"tango\",\"thegamebyhotornot\",\"tinder\",\"twoo\",\"wechat\",\"whisper\",\"zoosk\",\"landrover\",\"landrover.com\",\"landrovertristate.com\"],\"bcat\":[\"IAB25\",\"IAB25-2\",\"IAB25-3\",\"IAB25-4\",\"IAB25-5\",\"IAB26\",\"IAB26-1\",\"IAB26-2\",\"IAB26-3\",\"IAB26-4\",\"IAB3-7\"],\"device\":{\"carrier\":\"310-VZW\",\"connectiontype\":2,\"devicetype\":2,\"dnt\":0,\"dpidmd5\":\"9c6b132814c572f4eaad3bea5ad92354\",\"dpidsha1\":\"5096f9a6db54780f8f87c3736eb5063b3584d501\",\"ext\":{\"idfa\":\"203D9D0B-558D-4BDD-A186-9183546D9755\"},\"geo\":{\"city\":\"Saint Augustine\",\"country\":\"USA\",\"lat\":29.9475,\"lon\":-81.5264,\"metro\":\"109\",\"region\":\"FL\",\"zip\":\"32092\"},\"ip\":\"66.102.160.1\",\"js\":1,\"language\":\"en\",\"make\":\"Apple\",\"model\":\"iPhone 5S\",\"os\":\"iOS\",\"osv\":\"9\",\"ua\":\"Dalvik/2.1.0 (Linux; U; Android 5.1; XT1254 Build/SU3TL-39)\"},\"id\":\"09658018-6772-4e16-8fda-7a510bf61988\",\"imp\":[{\"banner\":{\"api\":[3,5],\"battr\":[1,3,8,9,10,14,6],\"btype\":[4],\"ext\":{\"nativebrowserclick\":1},\"h\":249,\"pos\":1,\"w\":300},\"bidfloor\":1,\"displaymanager\":\"mopub\",\"displaymanagerver\":\"3.7.0\",\"ext\":{\"secure\":0},\"id\":\"1\",\"instl\":0,\"tagid\":\"f5ea2d24c9bb46a38713cf98dffd8252\"}],\"user\":{\"gender\":\"f\",\"ext\":{\"age\":72},\"keywords\":\"ETHNICITY:NONE,RELIGION:NONE,AGE:21,INTERESTED_IN:WOMEN,EDUCATION:NONE,RELATIONSIP_STATUS:SINGLE,PARENTAL_STATE:NONE,GENDER:m\"}}";
//	Assert.assertEquals("This mopub request should not bid.", "No Bid", RequestCSVs.request(moPubRequest2));
//	Thread.sleep(2000);
//	System.out.println("Sending a bid request that matches targeting.  With the new targeting in place, this request is expected to bid");
//	String moPubRequest4 = "{\"app\":{\"bundle\":\"372648912\",\"cat\":[\"IAB24\",\"social_networking\"],\"id\":\"ba411a3edf074a9a9792ff8c56e193ae\",\"name\":\"MeetMe iPhone\",\"publisher\":{\"id\":\"c3584d1c40cb43619e043c065caee33a\",\"name\":\"MeetMe, Inc.\"},\"storeurl\":\"https://itunes.apple.com/us/app/meetme-chat-meet-new-people/id372648912?mt=8&uo=4\",\"ver\":\"10.3.0\"},\"at\":2,\"badv\":[\"badoo\",\"chatmeup\",\"fling\",\"happn\",\"howaboutwe\",\"imvu\",\"jaumo\",\"justhookup\",\"lavaplace\",\"lovoo\",\"meetmoi\",\"meowchat\",\"moco\",\"momo\",\"on.com\",\"pof\",\"sayhi\",\"skout\",\"tagged\",\"tango\",\"thegamebyhotornot\",\"tinder\",\"twoo\",\"wechat\",\"whisper\",\"zoosk\",\"landrover\",\"landrover.com\",\"landrovertristate.com\"],\"bcat\":[\"IAB25\",\"IAB25-2\",\"IAB25-3\",\"IAB25-4\",\"IAB25-5\",\"IAB26\",\"IAB26-1\",\"IAB26-2\",\"IAB26-3\",\"IAB26-4\",\"IAB3-7\"],\"device\":{\"carrier\":\"310-VZW\",\"connectiontype\":2,\"devicetype\":1,\"dnt\":0,\"dpidmd5\":\"9c6b132814c572f4eaad3bea5ad92354\",\"dpidsha1\":\"5096f9a6db54780f8f87c3736eb5063b3584d501\",\"ext\":{\"idfa\":\"203D9D0B-558D-4BDD-A186-9183546D9755\"},\"geo\":{\"city\":\"Rancho Cucamonga\",\"country\":\"USA\",\"lat\":34.118733,\"lon\":-117.56488,\"metro\":\"803\",\"region\":\"CA\",\"zip\":\"91730\"},\"ip\":\"108.38.247.146\",\"js\":1,\"language\":\"en\",\"make\":\"Apple\",\"model\":\"iPhone 4S\",\"os\":\"iOS\",\"osv\":\"7.1.1\",\"ua\":\"Mozilla/5.0 (iPad; CPU OS 9_0 like Mac OS X) AppleWebKit/601.1.16 (KHTML, like Gecko) Version/8.0 Mobile/13A171a Safari/600.1.4\"},\"id\":\"09658018-6772-4e16-8fda-7a510bf61988\",\"imp\":[{\"banner\":{\"api\":[3,5],\"battr\":[1,3,8,9,10,14,6],\"btype\":[4],\"ext\":{\"nativebrowserclick\":1},\"h\":249,\"pos\":1,\"w\":300},\"bidfloor\":1,\"displaymanager\":\"mopub\",\"displaymanagerver\":\"3.7.0\",\"ext\":{\"secure\":0},\"id\":\"1\",\"instl\":0,\"tagid\":\"f5ea2d24c9bb46a38713cf98dffd8252\"}],\"user\":{\"gender\":\"f\",\"ext\":{\"age\":72},\"keywords\":\"ETHNICITY:NONE,RELIGION:NONE,AGE:21,INTERESTED_IN:WOMEN,EDUCATION:NONE,RELATIONSIP_STATUS:SINGLE,PARENTAL_STATE:NONE,GENDER:m\"}}";
//	Assert.assertNotEquals("This mopub request should not bid.", "No Bid", RequestCSVs.request(moPubRequest4));
//	Thread.sleep(2000);
//
//	Thread.sleep(2000);
//	System.out.println("Done");
//	System.out.println("Closing the browser.  Test Complete");
//	
//	}

@Test
	public void testDeviceTargetingDeviceiPADOSiOSv9WifiComcastScenario() throws InterruptedException, ParseException, IOException {
	System.out.println("Device Targeting Device iPADOS iOSv9 Wifi Comcast Scenario");
	DeviceTargeting myDevTargeting = new DeviceTargeting(new FirefoxDriver());
	myDevTargeting.resetAllDeviceTargeting(); //This is inserted here as these test scripts are run randomly
	Thread.sleep(10000);//Needed sleep so changes propagate through the DB
	System.out.println("There should be NO targeting in place so this is expected to bid.");
	String moPubRequest1 = "{\"app\":{\"bundle\":\"372648912\",\"cat\":[\"IAB24\",\"social_networking\"],\"id\":\"ba411a3edf074a9a9792ff8c56e193ae\",\"name\":\"MeetMe iPhone\",\"publisher\":{\"id\":\"c3584d1c40cb43619e043c065caee33a\",\"name\":\"MeetMe, Inc.\"},\"storeurl\":\"https://itunes.apple.com/us/app/meetme-chat-meet-new-people/id372648912?mt=8&uo=4\",\"ver\":\"10.3.0\"},\"at\":2,\"badv\":[\"badoo\",\"chatmeup\",\"fling\",\"happn\",\"howaboutwe\",\"imvu\",\"jaumo\",\"justhookup\",\"lavaplace\",\"lovoo\",\"meetmoi\",\"meowchat\",\"moco\",\"momo\",\"on.com\",\"pof\",\"sayhi\",\"skout\",\"tagged\",\"tango\",\"thegamebyhotornot\",\"tinder\",\"twoo\",\"wechat\",\"whisper\",\"zoosk\",\"landrover\",\"landrover.com\",\"landrovertristate.com\"],\"bcat\":[\"IAB25\",\"IAB25-2\",\"IAB25-3\",\"IAB25-4\",\"IAB25-5\",\"IAB26\",\"IAB26-1\",\"IAB26-2\",\"IAB26-3\",\"IAB26-4\",\"IAB3-7\"],\"device\":{\"carrier\":\"310-VZW\",\"connectiontype\":2,\"devicetype\":2,\"dnt\":0,\"dpidmd5\":\"9c6b132814c572f4eaad3bea5ad92354\",\"dpidsha1\":\"5096f9a6db54780f8f87c3736eb5063b3584d501\",\"ext\":{\"idfa\":\"203D9D0B-558D-4BDD-A186-9183546D9755\"},\"geo\":{\"city\":\"Saint Augustine\",\"country\":\"USA\",\"lat\":29.9475,\"lon\":-81.5264,\"metro\":\"109\",\"region\":\"FL\",\"zip\":\"32092\"},\"ip\":\"66.102.160.1\",\"js\":1,\"language\":\"en\",\"make\":\"Apple\",\"model\":\"iPhone 5S\",\"os\":\"iOS\",\"osv\":\"9\",\"ua\":\"Dalvik/2.1.0 (Linux; U; Android 5.1; XT1254 Build/SU3TL-39)\"},\"id\":\"09658018-6772-4e16-8fda-7a510bf61988\",\"imp\":[{\"banner\":{\"api\":[3,5],\"battr\":[1,3,8,9,10,14,6],\"btype\":[4],\"ext\":{\"nativebrowserclick\":1},\"h\":249,\"pos\":1,\"w\":300},\"bidfloor\":1,\"displaymanager\":\"mopub\",\"displaymanagerver\":\"3.7.0\",\"ext\":{\"secure\":0},\"id\":\"1\",\"instl\":0,\"tagid\":\"f5ea2d24c9bb46a38713cf98dffd8252\"}],\"user\":{\"gender\":\"f\",\"ext\":{\"age\":72},\"keywords\":\"ETHNICITY:NONE,RELIGION:NONE,AGE:21,INTERESTED_IN:WOMEN,EDUCATION:NONE,RELATIONSIP_STATUS:SINGLE,PARENTAL_STATE:NONE,GENDER:m\"}}";
	Assert.assertNotEquals("This mopub request should have bid.", "No Bid", RequestCSVs.request(moPubRequest1));

	myDevTargeting.deviceiPADOSiOSv9WifiComcastOS();
//	Thread.sleep(8000);
//	myDevTargeting.deviceiPADOSiOSv9WifiComcastWifi();
	Thread.sleep(10000);
	System.out.println("With the new targeting in place, this request is NOT expected to bid");
	String moPubRequest2 = "{\"app\":{\"bundle\":\"372648912\",\"cat\":[\"IAB24\",\"social_networking\"],\"id\":\"ba411a3edf074a9a9792ff8c56e193ae\",\"name\":\"MeetMe iPhone\",\"publisher\":{\"id\":\"c3584d1c40cb43619e043c065caee33a\",\"name\":\"MeetMe, Inc.\"},\"storeurl\":\"https://itunes.apple.com/us/app/meetme-chat-meet-new-people/id372648912?mt=8&uo=4\",\"ver\":\"10.3.0\"},\"at\":2,\"badv\":[\"badoo\",\"chatmeup\",\"fling\",\"happn\",\"howaboutwe\",\"imvu\",\"jaumo\",\"justhookup\",\"lavaplace\",\"lovoo\",\"meetmoi\",\"meowchat\",\"moco\",\"momo\",\"on.com\",\"pof\",\"sayhi\",\"skout\",\"tagged\",\"tango\",\"thegamebyhotornot\",\"tinder\",\"twoo\",\"wechat\",\"whisper\",\"zoosk\",\"landrover\",\"landrover.com\",\"landrovertristate.com\"],\"bcat\":[\"IAB25\",\"IAB25-2\",\"IAB25-3\",\"IAB25-4\",\"IAB25-5\",\"IAB26\",\"IAB26-1\",\"IAB26-2\",\"IAB26-3\",\"IAB26-4\",\"IAB3-7\"],\"device\":{\"carrier\":\"310-VZW\",\"connectiontype\":2,\"devicetype\":1,\"dnt\":0,\"dpidmd5\":\"9c6b132814c572f4eaad3bea5ad92354\",\"dpidsha1\":\"5096f9a6db54780f8f87c3736eb5063b3584d501\",\"ext\":{\"idfa\":\"203D9D0B-558D-4BDD-A186-9183546D9755\"},\"geo\":{\"city\":\"Rancho Cucamonga\",\"country\":\"USA\",\"lat\":34.118733,\"lon\":-117.56488,\"metro\":\"803\",\"region\":\"CA\",\"zip\":\"91730\"},\"ip\":\"108.38.247.146\",\"js\":1,\"language\":\"en\",\"make\":\"Apple\",\"model\":\"iPhone 4S\",\"os\":\"iOS\",\"osv\":\"7.1.1\",\"ua\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 7_1_1 like Mac OS X) AppleWebKit/537.51.2 (KHTML, like Gecko) Mobile/11D201\"},\"id\":\"09658018-6772-4e16-8fda-7a510bf61988\",\"imp\":[{\"banner\":{\"api\":[3,5],\"battr\":[1,3,8,9,10,14,6],\"btype\":[4],\"ext\":{\"nativebrowserclick\":1},\"h\":249,\"pos\":1,\"w\":300},\"bidfloor\":1,\"displaymanager\":\"mopub\",\"displaymanagerver\":\"3.7.0\",\"ext\":{\"secure\":0},\"id\":\"1\",\"instl\":0,\"tagid\":\"f5ea2d24c9bb46a38713cf98dffd8252\"}],\"user\":{\"gender\":\"f\",\"ext\":{\"age\":72},\"keywords\":\"ETHNICITY:NONE,RELIGION:NONE,AGE:21,INTERESTED_IN:WOMEN,EDUCATION:NONE,RELATIONSIP_STATUS:SINGLE,PARENTAL_STATE:NONE,GENDER:m\"}}";
	Assert.assertEquals("This mopub request should not bid.", "No Bid", RequestCSVs.request(moPubRequest2));
	Thread.sleep(2000);
	System.out.println("Done");
}
}